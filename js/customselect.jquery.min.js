/*!
 * jQuery Custom Select Plugin 1.22
 * 2013-04-05
 *
 * http://www.blissmedia.com.au/
 *
 * Copyright 2013 Bliss Media
 * Released under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 */

;(function(e){e.fn.customselect=function(t,n){e(this).each(function(){var r={csclass:"custom-select",search:true,numitems:4,searchblank:false,showblank:true,searchvalue:false,hoveropen:false};var i=navigator.platform&&navigator.platform.match(/(android|iphone|ipad|blackberry)/)?true:false;var s=e(this);var o=s.parents(r.selector+":first");var u={init:function(){var t={init:function(){t.container();t.value();t.subcontainer()},container:function(){o=e("<div/>").addClass(r.csclass);s.before(o);s.appendTo(o);s.change(function(){u.select(e(this).val())});var t=null;o.hover(function(){if(t)clearTimeout(t);o.addClass(r.csclass+"-hover")},function(){if(r.hoveropen)t=setTimeout(u.close,750);o.removeClass(r.csclass+"-hover")});e(window,document).mouseup(function(){if(!o.is(r.selector+"-hover"))u.close();else o.find("input").focus()})},value:function(){var t=e("<span/>").appendTo(o);t.html(s.find("option:selected").text());if(r.hoveropen){t.mouseover(u.open)}else{t.click(u.toggle)}},subcontainer:function(){var t=e("<div/>").appendTo(o);var n=e("<input type='input'/>").appendTo(t);n.keyup(function(t){if(r.search&&e.inArray(t.which,[13,38,40])<0){u.search(e(this).val())}}).keydown(function(e){switch(e.which){case 13:val=o.find("ul li.active.option-hover").data("value");u.select(val);break;case 38:u.selectUp();break;case 40:u.selectDown();break;default:return true;break}e.preventDefault();return false}).blur(function(){e(this).val("")});if(!r.search){n.addClass(r.csclass+"-hidden-input")}var i=e("<div/>").appendTo(t);var a=e("<ul/>").appendTo(i);s.find("option").each(function(t){var n=e(this).attr("value");if(r.showblank||n.length>0){e("<li/>",{"class":"active"+(t==0?" option-hover":""),"data-value":n,text:e(this).text()}).appendTo(a)}});var f=a.find("li");a.find("li").click(function(){u.select(e(this).data("value"))});o.find("div div").css({"overflow-y":f.length>r.numitems?"scroll":"visible"});e("<li/>",{"class":"no-results",text:"No results"}).appendTo(a)}};if(s.is("select"+r.selector)){t.init()}},toggle:function(){if(o.is(r.selector+"-open")){u.close()}else{u.open()}},open:function(){o.addClass(r.csclass+"-open");o.find("input").focus();o.find("ul li.no-results").hide();u._selectMove(s[0].selectedIndex)},close:function(){o.removeClass(r.csclass+"-open");o.find("input").val("").blur();o.find("ul li").not(".no-results").addClass("active");var e=o.find("ul li").not(".no-results");o.find("div div").css({"overflow-y":e.length>r.numitems?"scroll":"visible"})},search:function(t){t=t.toLowerCase();var n=o.find("ul li.no-results").hide();var i=o.find("ul li").not(".no-results");i.each(function(){var n=(e(this).text()+"").toLowerCase();var i=(e(this).data("value")+"").toLowerCase();e(this).removeClass("active");if(r.searchblank||i.length>0){if(r.searchvalue&&i.indexOf(t)>=0){e(this).addClass("active")}else if(n.indexOf(t)>=0){e(this).addClass("active")}}});i=i.filter(".active").filter(":visible");o.find("div div").css({"overflow-y":i.length>r.numitems?"scroll":"visible"});if(i.length>0){u._selectMove(0)}else{n.show()}},select:function(e){if(s.val()!=e){s.val(e).change()}o.find("span").text(s.find("option:selected").text());u.close()},selectUp:function(){var e=o.find("ul li.active").not(".no-results");var t=e.index(e.filter(".option-hover"));var n=t-1;n=n<0?e.length-1:n;u._selectMove(n)},selectDown:function(){var e=o.find("ul li.active").not(".no-results");var t=e.index(e.filter(".option-hover"));var n=t+1;n=n>e.length-1?0:n;u._selectMove(n)},_selectMove:function(e){var t=o.find("ul li.active");t.removeClass("option-hover").eq(e).addClass("option-hover");var n=o.find("div div");if(n.css("overflow-y")=="scroll"){n.scrollTop(0);if(e+1>r.numitems){offset=t.eq(e+1-r.numitems).offset().top-n.offset().top;n.scrollTop(offset)}}}};if(t&&typeof t=="object"){e.extend(r,t);t="init";n=null}r.selector="."+r.csclass;t=t?t:"init";if(typeof u[t]=="function"){u[t].call(this,n)}})}})(jQuery)